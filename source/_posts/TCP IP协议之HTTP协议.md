---
title: TCP/IP协议之HTTP协议
date: {{data}}
tags: HTTP协议
categories: TCP/IP协议
---

## TCP/IP协议之HTTP协议

### 简介

HTTP全称是HyperText Transfer Protocal，即：超文本传输协议。超文本传输协议(HTTP)是一种通信协议，它允许将超文本标记语言(HTML)文档从Web服务器传送到客户端的浏览器。<br/>
从1990年开始就在WWW上广泛应用，是现今在WWW上应用最多的议<br/>
Http是应用层协议。<br/>
HTTP协议工作于客户端-服务端架构为上。浏览器作为HTTP客户端通过URL向HTTP服务端即WEB服务器发送所有请求。Web服务器根据接收到的请求后，向客户端发送响应信息。Http是一个基于请求/响应模式的、无状态的协议。即我们通常所说的Request/Response。

### HTTP协议的特点

1. 支持B/S及C/S模式
2. 简单快速：请求方法常用的有GET、HEAD、POST。每种方法规定了客户与服务器联系的类型不同。由于HTTP协议简单，使得HTTP服务器的程序规模小，因而通信速度很快。
3. 灵活：HTTP允许传输任意类型的数据对象。正在传输的类型由Content-Type加以标记。
4. 无连接：无连接的含义是限制每次连接只处理一个请求。服务器处理完客户的请求，并收到客户的应答后，即断开连接。采用这种方式可以节省传输时间。
5. 无状态：HTTP协议是无状态协议。无状态是指协议对于事务处理没有记忆能力。缺少状态意味着如果后续处理需要前面的信息，则它必须重传，这样可能导致每次连接传送的数据量增大。另一方面，在服务器不需要先前信息时它的应答就较快。

### HTTP协议之URL
HTTP使用统一资源标识符（Uniform Resource Identifiers, URI）来传输数据和建立连接。URL是一种特殊类型的URI，包含了用于查找某个资源的足够的信息<br/>

URL,全称是Uniform&nbsp;Resource&nbsp;Locator, 中文叫统一资源定位符,是互联网上用来标识某一处资源的地址。以下面这个URL为例，介绍下普通URL的各部分组成：<br/>
`http://www.aspxfans.com:8080/news/index.asp?boardID=5&ID=24618&page=1#name`
从上面的URL可以看出，一个完整的URL包括以下几部分：
1. 协议部分：该URL的协议部分为“http：”，这代表网页使用的是HTTP协议。在Internet中可以使用多种协议，如HTTP，FTP等等本例中使用的是HTTP协议。在"HTTP"后面的“//”为分隔符

2. 域名部分：该URL的域名部分为“www.aspxfans.com”。一个URL中，也可以使用IP地址作为域名使用

3. 端口部分：跟在域名后面的是端口，域名和端口之间使用“:”作为分隔符。端口不是一个URL必须的部分，如果省略端口部分，将采用默认端口

4. 虚拟目录部分：从域名后的第一个“/”开始到最后一个“/”为止，是虚拟目录部分。虚拟目录也不是一个URL必须的部分。本例中的虚拟目录是“/news/”

5. 文件名部分：从域名后的最后一个“/”开始到“？”为止，是文件名部分，如果没有“?”,则是从域名后的最后一个“/”开始到“#”为止，是文件部分，如果没有“？”和“#”，那么从域名后的最后一个“/”开始到结束，都是文件名部分。本例中的文件名是“index.asp”。文件名部分也不是一个URL必须的部分，如果省略该部分，则使用默认的文件名

6. 锚部分：从“#”开始到最后，都是锚部分。本例中的锚部分是“name”。锚部分也不是一个URL必须的部分

7. 参数部分：从“？”开始到“#”为止之间的部分为参数部分，又称搜索部分、查询部分。本例中的参数部分为“boardID=5&ID=24618&page=1”。参数可以允许有多个参数，参数与参数之间用“&”作为分隔符。
（原文：http://blog.csdn.net/ergouge/article/details/8185219 ）

### HTTP协议之Request
http请求由四部分组成，分别是：请求行、请求头部、空行、请求正文<br/>
HTTP的请求方式包括如下几种：
- GET(请求获取Request-URI所标识的资源)
- POST(在Request-URI所标识的资源后附加新的数据)
- HEAD(请求获取由Request-URI所标识的资源的响应消息报头)
- PUT(请求服务器存储一个资源，并用Request-URI作为其标识)
- DELETE(请求服务器删除Request-URI所标识的资源)
- OPTIONS(请求查询服务器的性能，或者查询与资源相关的选项和需求)
- TRACK(请求服务器回送收到的请求信息，主要用于测试或诊断)
- CONNECT(保留将来使用)<br/>

GET请求为例如下：<br/>
`GET /562f25980001b1b106000338.jpg HTTP/1.1`<br/>
`Host    img.mukewang.com`<br/>
`User-Agent    Mozilla/5.0 (Windows NT 10.0; WOW64)`<br/> `AppleWebKit/537.36 (KHTML, like Gecko)`<br/> `Chrome/51.0.2704.106 Safari/537.36`<br/>
`Accept    image/webp,image/*,*/*;q=0.8`<br/>
`Referer    http://www.imooc.com/`<br/>
`Accept-Encoding    gzip, deflate, sdch`<br/>
`Accept-Language    zh-CN,zh;q=0.8`<br/>


  1. 第一部分，请求行：<br/>
    格式如下：<br/>
    方法 [空格] 请求URI [空格] 版本号 [回车换行]<br/>
    Method&nbsp;Request-URI&nbsp;HTTP-Version CRLF（CRLF表示回车和换行，除了作为结尾的CRLF外，不允许出现单独的CR或LF字符）。<br/>
    例如：GET&nbsp;/form.html&nbsp;HTTP/1.1&nbsp;(CRLF)
  2. 第二部分，请求头部。紧接着请求行（即第一行）之后的部分，用来说明服务器要使用的附加信息。<br/>
  从第二行起为请求头部，HOST将指出请求的目的地.User-Agent,服务器端和客户端脚本都能访问它,它是浏览器类型检测逻辑的重要基础.该信息由你的浏览器来定义,并且在每个请求中自动发送等等。<br/>
  3. 第三部分：空行，请求头部后面的空行是必须的<br/>
  即使第四部分的请求数据为空，也必须有空行。<br/>
  4. 第四部分：请求数据也叫主体，可以添加任意的其他数据。<br/>
  这个例子的请求数据为空。<br/>
### HTTP协议之Response
一般般情况下，服务器接收并处理客户端发过来的请求后会返回一个HTTP的响应消息。<br/>
HTTP响应也由四个部分组成，分别是：状态行、消息报头、空行和响应正文。<br/>
一个完整的response如下：<br/>
`HTTP/1.1 200 OK`<br/>
`Date: Fri, 22 May 2009 06:07:21 GMT`<br/>
`Content-Type: text/html; charset=UTF-8`<br/>
`空行`<br/>
`<html>`<br/>
  `<head></head>`<br/>
  `<body>`<br/>
      `<!--body goes here-->`<br/>
  `</body>`<br/>
`</html>`<br/>

1. 第一部分，状态行。<br/>
格式如下：<br/>
版本号 [空格] 状态码 [空格] 原因 [回车换行]<br/>
例子中（HTTP/1.1）表明HTTP版本为1.1版本，状态码为200，状态消息为（ok）
2. 第二部分，消息报头，用来说明客户端要使用的一些附加信息。<br/>
例子中第二行和第三行为消息报头，
Date:生成响应的日期和时间；Content-Type:指定了MIME类型的HTML(text/html),编码类型是UTF-8<br/>
3. 第三部分，空行，消息报头后面的空行是必须的<br/>
4. 第四部分，响应正文，服务器返回给客户端的文本信息。<br/>
空行后面的html部分为响应正文。<br/>
#### HTTP状态码
状态代码有三位数字组成，第一个数字定义了响应的类别，且有五种可能取值：<br/>
  - 1xx：指示信息--表示请求已接收，继续处理<br/>
    - 100——客户必须继续发出请求<br/>
    - 101——客户要求服务器根据请求转换HTTP协议版本<br/>
  - 2xx：成功--表示请求已被成功接收、理解、接受
    - 200——交易成功
    - 201——提示知道新文件的URL
    - 202——接受和处理、但处理未完成
    - 203——返回信息不确定或不完整
    - 204——请求收到，但返回信息为空
    - 205——服务器完成了请求，用户代理必须复位当前已经浏览过的文件
    - 206——服务器已经完成了部分用户的GET请求
  - 3xx：重定向--要完成请求必须进行更进一步的操作
    - 300——请求的资源可在多处得到
    - 301——删除请求数据
    - 302——在其他地址发现了请求数据
    - 303——建议客户访问其他URL或访问方式
    - 304——客户端已经执行了GET，但文件未变化
    - 305——请求的资源必须从服务器指定的地址得到
    - 306——前一版本HTTP中使用的代码，现行版本中不再使用
    - 307——申明请求的资源临时性删除
  - 4xx：客户端错误--请求有语法错误或请求无法实现
    - 400——错误请求，如语法错误
    - 401——未授权
      - HTTP 401.1 - 未授权：登录失败
      - HTTP 401.2 - 未授权：服务器配置问题导致登录失败
      - HTTP 401.3 - ACL 禁止访问资源
      - HTTP 401.4 - 未授权：授权被筛选器拒绝
      - HTTP 401.5 - 未授权：ISAPI 或 CGI 授权失败
    - 402——保留有效ChargeTo头响应
    - 403——禁止访问
      - HTTP 403.1 禁止访问：禁止可执行访问
      - HTTP 403.2 - 禁止访问：禁止读访问
      - HTTP 403.3 - 禁止访问：禁止写访问
      - HTTP 403.4 - 禁止访问：要求 SSL
      - HTTP 403.5 - 禁止访问：要求 SSL 128
      - HTTP 403.6 - 禁止访问：IP 地址被拒绝
      - HTTP 403.7 - 禁止访问：要求客户证书
      - HTTP 403.8 - 禁止访问：禁止站点访问
      - HTTP 403.9 - 禁止访问：连接的用户过多
      - HTTP 403.10 - 禁止访问：配置无效
      - HTTP 403.11 - 禁止访问：密码更改
      - HTTP 403.12 - 禁止访问：映射器拒绝访问
      - HTTP 403.13 - 禁止访问：客户证书已被吊销
      - HTTP 403.15 - 禁止访问：客户访问许可过多
      - HTTP 403.16 - 禁止访问：客户证书不可信或者无效
      - HTTP 403.17 - 禁止访问：客户证书已经到期或者尚未生效
    - 404——没有发现文件、查询或URl
    - 405——用户在Request-Line字段定义的方法不允许
    - 406——根据用户发送的Accept拖，请求资源不可访问
    - 407——类似401，用户必须首先在代理服务器上得到授权
    - 408——客户端没有在用户指定的饿时间内完成请求
    - 409——对当前资源状态，请求不能完成
    - 410——服务器上不再有此资源且无进一步的参考地址
    - 411——服务器拒绝用户定义的Content-Length属性请求
    - 412——一个或多个请求头字段在当前请求中错误
    - 413——请求的资源大于服务器允许的大小
    - 414——请求的资源URL长于服务器允许的长度
    - 415——请求资源不支持请求项目格式
    - 416——请求中包含Range请求头字段，在当前请求资源范围内没有range指示值，请求也不包含If-Range请求头字段
    - 417——服务器不满足请求Expect头字段指定的期望值，如果是代理服务器，可能是下一级服务器不能满足请求长。
  - 5xx：服务器端错误--服务器未能实现合法的请求
    - HTTP 500 - 内部服务器错误
      - HTTP 500.100 - 内部服务器错误 - ASP 错误
      - HTTP 500-11 服务器关闭
      - HTTP 500-12 应用程序重新启动
      - HTTP 500-13 - 服务器太忙
      - HTTP 500-14 - 应用程序无效
      - HTTP 500-15 - 不允许请求 global.asa
    - Error 501 - 未实现
    - HTTP 502 - 网关错误

### URI和URL的区别
