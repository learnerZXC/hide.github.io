---
title: JavaScript中this指向
date: 2018-09-13 22:33:33
tags: this
categories: JavaScript
---

# Javascript 中的this指向



### 前言

本文根据《你所不知道的 JavaScript》上卷中的内容总结了 this的绑定规则，用于以后学习回顾，防止遗忘。

### 什么是this？

​	当一个函数被调用时，会创建函数活动记录(有时也成为执行上下文)。这个记录会包含函数在哪里被调用(调用栈)、函数的方法，传入的参数等信息。this 就是记录的其中的一个属性，会在函数执行过程中用到。

### this指向哪里？

​	this是在运行时绑定的，并不是在编写时绑定的。它的上下文取决于函数调用的各种条件。this的绑定和函数声明的位置没有任何关系，只取决于函数的调用方式。

​	this 在任何情况下都不指向函数的词法作用域。

	#### 调用位置

​	调用位置就是函数在代码中被调用的位置(而不是被声明的位置)。通常来说，寻找调用位置就是寻找"函数被调用的位置"。 某些变成可能会隐藏真正的调用位置。最重要的是分析调用栈(就是为了到达当前调用位置所调用的所有函数)。我们关心调用位置就在当前正在执行的函数的前一个调用中。

​	可以把调用栈想象成一个函数调用链，但是这种方法非常麻烦并且容易出错。另一个查看调用栈的方法是使用浏览器的调试工具。使用浏览器包含的 Javascript调试器。可以在被调用函数的第一行代码设置一个断点，或者直接在第一行代码之前插入一个 debugger；语句。运行代码时，调试器会在那个位置暂停，同时会展示当前位置函数的调用列表。这就是调用栈。因此，如果想要分析 this 的绑定，使用开发者工具得到调用栈，然后找到占中的第二个元素，这就是真正的调用位置。

#### 绑定规则

##### 默认绑定

​	默认绑定纪即无法应用其它规则时的默认规则。独立函数调用时（如下 foo()是直接使用不带任何修饰的函数引用进行调用的），应用了默认绑定，this指向全局对象。

​	

```javascript
function foo() {
  console.log( this.a );
}
var a = 2;
foo();	//2
```

​	如果使用严格模式(strict mode),那么全局对象将无法使用默认绑定，因此this会绑定到 undefined:

```javascript
function foo() {
  "use strict"
  
  console.log( this.a );
}
var a = 2;
foo();	// TypeError: this is undefined
```



##### 隐式绑定

##### 显式绑定

##### new 绑定